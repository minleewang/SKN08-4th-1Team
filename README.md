# SKN08-4th-1Team
SKN08-4th-1Team

<div align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:000000,70:003300,100:00FF00&height=240&text=SKN08-4th-1Team&animation=&fontColor=00FF00&fontSize=90" width="1000" />

  <img width="1000" alt="image" src="https://github.com/Jh-jaehyuk/Jh-jaehyuk.github.io/assets/126551524/7ea63fc3-95f0-44d5-a0f0-cf431cae34f1"> 

</div>



# 1. Introduction Team (íŒ€ ì†Œê°œ)
### âœ… íŒ€ëª… : JOBSTICK
<table align=center>
  <tbody>
    <tr>
      <td align=center><b>ì™•í™˜ë¯¼</b></td>
      <td align=center><b>ê¹€í˜„ìš°</b></td>
      <td align=center><b>ì–‘ì˜ì •</b></td>
      <td align=center><b>ìµœë³‘ì¤€</b></td>
      <td align=center><b>ì˜¤ë¯¼ìˆ˜</b></td>
    </tr>
    <tr>
      <td align="center">
        <div>
          <img width="200" alt="image" src="https://github.com/user-attachments/assets/d3a14a4d-9f6a-4c66-b61d-bac75bb6cc82">
        </div>
      </td>
      <td align="center">
        <div>
          <img src = "https://github.com/user-attachments/assets/ea1c1774-e583-46e8-9f43-576069ce87df" width="200px" height="200px"; alt=""/>
        </div>
      </td>
      <td align="center">
        <div>
          <img src="https://avatars.githubusercontent.com/u/100367503?v=4" width="200" height="200">
        </div>
      </td>
      <td align="center">
        <img width="200" height="200" alt="image" src="https://github.com/user-attachments/assets/f2e34e70-8c21-4864-aa4f-0b7cb619760b" />
      </td>
      <td align="center">
        <img width="200" height="200" alt="image" src="https://github.com/user-attachments/assets/bca069a5-528f-4a32-924c-b62d515fac11" />
      </td>
    </tr>
    <tr>
      <td><a href="https://github.com/minleewang"><div align=center>@Hwan-Min</div></a></td>
      <td><a href="https://github.com/kimhyeonu4586"><div align=center>@hyeonu-kim</div></a></td>
      <td><a href="https://github.com/UiJungYang"><div align=center>@UiJungYang</div></a></td>
      <td><a href="https://github.com/ChoiByuengJun"><div align=center>@ChoiByuengJun</div></a></td>
      <td><a href="https://github.com/yooodleee"><div align=center>@yooodleee</div></a></td>
    </tr>
  </tbody>
</table>
<br><br><br>

# 2. Introduction Project (í”„ë¡œì íŠ¸ ê°œìš”)

### âœ…í”„ë¡œì íŠ¸ ëª…
LLMì´ ë¶™ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

### âœ…í”„ë¡œì íŠ¸ ì†Œê°œ
ì‘ê¸‰ ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ëŒ€ì²˜í•´ì•¼ í• ì§€ ëª°ë¼ ë§‰ë§‰í–ˆë˜ ê²½í—˜ì´ ìˆìœ¼ì…¨ë‚˜ìš”?
ì´ ì±—ë´‡ì€ ì‹¤ìƒí™œì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì‘ê¸‰ ìƒí™©ì— ëŒ€í•´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
ê³µì‹ ì˜ë£Œ ë°ì´í„°ì™€ LLMì„ ì—°ë™í•˜ê³  íŒŒì¸íŠœë‹í•˜ì—¬ ë³´ë‹¤ ì •í™•í•˜ê³  ì ì ˆí•œ ì‘ê¸‰ì²˜ì¹˜ ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### âœ…í”„ë¡œì íŠ¸ ëª©í‘œ
ì‘ê¸‰ì˜ë£Œí¬í„¸ E-GEN, ì§ˆë³‘ê´€ë¦¬ì²­ êµ­ê°€ê±´ê°•ì •ë³´í¬í„¸, êµ­ë¯¼ì¬ë‚œì•ˆì „í¬í„¸ì˜ ë°ì´í„°ë¥¼ í™œìš©í•´ LLM ê¸°ë°˜ ì‘ê¸‰ì²˜ì¹˜ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.
ì´ ê³¼ì •ì—ì„œ ëª¨ë¸ì„ ì„¤ì •í•˜ê³  ë°ì´í„°ë¥¼ í•™ìŠµí•˜ë©°, RAG ë°©ì‹ì„ ì ìš©í•´ ë³´ë‹¤ ì‹ ë¢°ë„ ë†’ì€ ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤.
<br><br><br>




# 3. Tech Stack (ê¸°ìˆ  ìŠ¤íƒ)

>### <span style="color:cyan"> Co-Work Tool </span>
<table>
  <tr>
    <td>Communication & Messenger</td>
    <td><img src="https://img.shields.io/badge/Discord-5865F2?style=flat&logo=Discord&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/Notion-000000?style=flat&logo=Notion&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/Slack-4A154B?style=flat&logo=Slack&logoColor=white"/></td>
  </tr>
  <tr>
    <td>Development & Merge</td>
    <td><img src="https://img.shields.io/badge/Git-F05032?style=flat&logo=Git&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/gitkraken-179287?style=flat&logo=Git&logoColor=gitkraken&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/django-092E20?style=flat-square&logo=django&logoColor=white"/></td>
  </tr>  
</table>

>### <span style="color:cyan"> Data Analysis </span>
<table>
  <tr>
    <td>PyCharm</td>
    <td><img src="https://img.shields.io/badge/pycharm-%23000000?style=flat&logo=pycharm&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/python-3776AB?style=flat&logo=python&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/chatGPT-74aa9c?logo=openai&logoColor=white"/></td>
    <td><img src="https://img.shields.io/badge/faker-FF5733?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAYFBMVEUAAAD+/v4PDw/5+fkBAQH+/v4AAAD+/v5vb29fX19DQ0PExMT9/f3n5+eVlZW/v7+fn59UVFRLS0tLS0tUVFRsbGxMTExGRkZmZmZ2dnafn5+bm5uUlJSIiIh9fX3BwcH39/fPz8/b29vLy8t8fHyDg4ODg4Pp6em3DWVtAAAAGnRSTlMAAQIDBAUGBwgJCgsMDQ4PEBESFBUWGxs7NYqzDwAAAIlJREFUGFdlj9tygkAQhi3zKsU1aSshKWqVu7v/f7eYMHAYgmDPPfyDmy5w+lvEwKkSUer06FCFgCI3IlxaOKIZaIh6v4Sk5pWXKaZBZo5AQ9jJ58plUsZoOJS0wDygmyRzL3La3F6Tu9kEjLZ5AvO4oHvHWEk3JHE2QsKbsv02F9B6Hz3y+0JzxP8QzGQ5WaQEUxsvrG3Jl8AAAAASUVORK5CYII="/></td>
  </tr>
</table> 
<br><br><br>

# 4. í”„ë¡œì íŠ¸ ì§„í–‰ ê³¼ì •
  
  ## **Preprocessing**
  
  ### 1. ë°ì´í„° ìˆ˜ì§‘
- í¬ë¡¤ë§ì„ í†µí•´ ì‘ê¸‰ì²˜ì¹˜ ë°ì´í„° ìˆ˜ì§‘ ì§„í–‰
- Jsonìœ¼ë¡œ íŒŒì¼ ì €ì¥

```python
import requests
from bs4 import BeautifulSoup
import json

url = "https://www.e-gen.or.kr/egen/first_aid_data.do"
headers = {"User-Agent": "Mozilla/5.0"}
response = requests.get(url, headers=headers)

data = []
if response.status_code == 200:
    soup = BeautifulSoup(response.text, "html.parser")
    articles = soup.find_all("div", class_="first-aid-item") 

    for article in articles:
        title = article.find("h3").text.strip()
        content = article.find("p").text.strip()
        data.append({"question": title, "answer": content})

# Json íŒŒì¼ì— ì €ì¥
    with open("emergency_qa.json", "w", encoding="utf-8") as f: 
        json.dump(data, f, ensure_ascii=False, indent=4)
else:
    print("í˜ì´ì§€ ìš”ì²­ ì‹¤íŒ¨", response.status_code)
```




  ### 2. íŒŒì¸íŠœë‹ í•™ìŠµ(KoAlpaca ê¸°ë°˜ LLM í•™ìŠµ)
  - KoAlpaca ë“± ì˜¤í”ˆì†ŒìŠ¤ LLMì„ ì‘ê¸‰ì²˜ì¹˜ QA ë°ì´í„°ë¡œ ì¶”ê°€ í•™ìŠµ
  - ì´ë¥¼ í†µí•´ ì±—ë´‡ì´ ì‘ê¸‰ì²˜ì¹˜ ê´€ë ¨ ì§ˆë¬¸ì— ë” ì •í™•í•œ ë‹µë³€ì„ ì œê³µ

```python
from transformers import AutoModelForCausalLM, AutoTokenizer, Trainer, TrainingArguments
import json

# ëª¨ë¸ ë° í† í¬ë‚˜ì´ì € ë¡œë“œ
model_name = "beomi/KoAlpaca-7B" 
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(model_name)

# ë°ì´í„° ë¡œë“œ
with open("emergency_qa.json", "r", encoding="utf-8") as f: 
    data = json.load(f)

# ë°ì´í„° í† í°í™”
train_data = [{"input_ids": tokenizer(q["question"], return_tensors="pt")["input_ids"], 
               "labels": tokenizer(q["answer"], return_tensors="pt")["input_ids"]}
              for q in data]

# í•™ìŠµ ì„¤ì •
training_args = TrainingArguments(   
    output_dir="./fine_tuned_model",
    per_device_train_batch_size=4,
    num_train_epochs=3,
    save_steps=500,
    logging_dir="./logs"
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=train_data
)

 # í•™ìŠµ ì‹¤í–‰
trainer.train()

# íŒŒì¸íŠœë‹ëœ ëª¨ë¸ ì €ì¥
model.save_pretrained("./fine_tuned_emergency_model")  
tokenizer.save_pretrained("./fine_tuned_emergency_model")
 ```


  
  ### 3. RAG(Faiss) ë²¡í„° ê²€ìƒ‰ êµ¬ì¶•
  - SBERTë¥¼ ì‚¬ìš©í•´ ì‘ê¸‰ì²˜ì¹˜ ë°ì´í„°ë¥¼ ë²¡í„°í™”í•˜ê³  Faissì— ì €ì¥
  - ì‚¬ìš©ìì˜ ì§ˆë¬¸ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ì‘ê¸‰ì²˜ì¹˜ ì •ë³´ë¥¼ ë¹ ë¥´ê²Œ ê²€ìƒ‰ ê°€ëŠ¥

```python
import faiss
import numpy as np
import json
from sentence_transformers import SentenceTransformer

# SBERT ê¸°ë°˜ ì„ë² ë”© ëª¨ë¸ ë¡œë“œ
model = SentenceTransformer("snunlp/KR-SBERT-V40K-klueNLI-augSTS") 

# ë°ì´í„° ë¡œë“œ
with open("emergency_qa.json", "r", encoding="utf-8") as f: 
    data = json.load(f)

# ì„ë² ë”© ë³€í™˜
embeddings = np.array([model.encode(q["answer"]) for q in data]) 

 # Faiss ì¸ë±ìŠ¤ ìƒì„±
d = embeddings.shape[1]  
index = faiss.IndexFlatL2(d)
index.add(embeddings)

# ì €ì¥
faiss.write_index(index, "faiss_index.bin")  
with open("texts.json", "w", encoding="utf-8") as f:
    json.dump(data, f, ensure_ascii=False, indent=4)
```

  
  
  ### 4. ìµœì¢… ì±—ë´‡ ìƒì„± (LLM + RAG ê²°í•©) 
  - ì¤€ë¹„í•œ ë°ì´í„°ì…‹ê³¼ íŒŒì¸íŠœë‹ ì „ëµì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨
  - í•™ìŠµ ê³¼ì •ì—ì„œ ì„¤ì •ëœ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì™€ ìµœì í™”ëœ ì•Œê³ ë¦¬ì¦˜ì„ ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ë¥¼ ì ì§„ì ìœ¼ë¡œ ì¡°ì •

```python
import faiss
import numpy as np
from transformers import AutoModelForCausalLM, AutoTokenizer
from sentence_transformers import SentenceTransformer
import json

 # ëª¨ë¸ ë° í† í¬ë‚˜ì´ì € ë¡œë“œ
model_path = "./fine_tuned_emergency_model" 
tokenizer = AutoTokenizer.from_pretrained(model_path)
model = AutoModelForCausalLM.from_pretrained(model_path)

# Faiss ì¸ë±ìŠ¤ ë¡œë“œ
index = faiss.read_index("faiss_index.bin")  
with open("texts.json", "r", encoding="utf-8") as f:
    texts = json.load(f)

# SBERT ì„ë² ë”© ëª¨ë¸ ë¡œë“œ
embedding_model = SentenceTransformer("snunlp/KR-SBERT-V40K-klueNLI-augSTS")  


def search_and_generate(query):
    # ì¿¼ë¦¬ ë²¡í„° ë³€í™˜
    query_vector = embedding_model.encode(query).reshape(1, -1)
    
    # Faiss ê²€ìƒ‰ (ìµœìƒìœ„ 3ê°œ ë¬¸ì„œ)
    D, I = index.search(query_vector, k=3)
    
    # ê²€ìƒ‰ëœ ë¬¸ì„œë“¤ ì—°ê²°
    context = "\n".join([texts[i]["answer"] for i in I[0]])

    # ëª¨ë¸ ì…ë ¥ í”„ë¡¬í”„íŠ¸ ìƒì„±
    prompt = f"ë‹¤ìŒ ì •ë³´ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ê¸‰ì²˜ì¹˜ ì§ˆë¬¸ì— ë‹µë³€í•˜ì„¸ìš”:\n\n{context}\n\nì§ˆë¬¸: {query}\në‹µë³€:"

    # ëª¨ë¸ ì‹¤í–‰
    input_ids = tokenizer(prompt, return_tensors="pt").input_ids
    output = model.generate(input_ids, max_length=200, pad_token_id=tokenizer.eos_token_id)

    return tokenizer.decode(output[0], skip_special_tokens=True)

# í…ŒìŠ¤íŠ¸
query = "í—ˆë¦¬ë¥¼ ë‹¤ì¹˜ë©´ ì–´ë–»ê²Œ í•´?"   
print(search_and_generate(query))
```

<br><br><br>
  ### 5. AWS ì„¤ì •
  -AWS ê³„ì • ìƒì„±
  ![image](https://github.com/user-attachments/assets/fc52d54b-65e6-4269-b332-0b8478d38646)

  -EC2 Instance ìƒì„±
  ![image (1)](https://github.com/user-attachments/assets/700e69a8-7a5c-446a-bf20-c041a1ade2e0)

  -AMI ì„¤ì •
  ![image (2)](https://github.com/user-attachments/assets/2d4a1545-cb6e-42c1-90ae-dad72ca33326)

  -í‚¤ í˜ì–´ ìƒì„±
  ![image (3)](https://github.com/user-attachments/assets/c9cc16ca-bbd0-45cb-a013-eb9e8742c7bc)

  -ë„¤íŠ¸ì›Œí¬ ì„¤ì •
  ![image (4)](https://github.com/user-attachments/assets/c7277623-0c58-4569-92d5-0b335decea05)

 -ìŠ¤í† ë¦¬ì§€ êµ¬ì„±
 ![image (5)](https://github.com/user-attachments/assets/13901b43-26f1-47ce-91e5-df4519bec94a)


 ### 6. AWSì— LLMí”„ë¡œì íŠ¸ ë°°í¬

 -EC2 ì„œë²„ì— ì›ê²© ì ‘ì†
 ![image (6)](https://github.com/user-attachments/assets/b66d7c7c-221b-4361-88ed-8c5051480a5a)


# 5. ê²°ê³¼
- ì§ˆë¬¸
<img width="299" alt="image" src="https://github.com/user-attachments/assets/1047d596-55c6-4dbb-86aa-445476f52614" />

- ë‹µë³€
<img width="305" alt="image" src="https://github.com/user-attachments/assets/34e13665-dc5c-4ebf-a79c-fe8cbebbc3be" />

-ë°°í¬ í™”ë©´
<img width="680" alt="í™”ë©´ ìº¡ì²˜ 2025-03-28 093049" src="https://github.com/user-attachments/assets/bd8afc21-d6a0-4362-a474-e83065ff61a1" />

<br><br><br>

# 8. í•œ ì¤„ íšŒê³ 
ğŸ¤“<b>ê¹€í˜„ìš°</b>  
_ ì›¹ì„ í†µí•´ ì§ì ‘ ë°°ë°°í¬í•´ë³´ë‹ˆ ìƒ‰ë‹¤ë¥¸ ê²½í—˜ì´ ë˜ì—ˆë‹¤.ğŸ‘_

ğŸ‘¨â€ğŸ’»<b>ì™•í™˜ë¯¼</b>  
_AWSì„ í†µí•´ ì´ëŸ¬í•œ ê²ƒë„ í•  ìˆ˜ ìˆë‹¤ëŠ”ê±¸ ì•Œê²Œëœ ì¢‹ì€ ê²½í—˜ì´ì—ˆë‹¤.ğŸ‘_

ğŸ˜º<b>ì–‘ì˜ì •</b>  
_ì§ì ‘ ë§Œë“  ì›¹ì„ ë² í¬í•´ë³´ë‹ˆ ì¬ë¯¸ìˆì—ˆë‹¤.ğŸ‘_

ğŸª<b>ìµœë³‘ì¤€</b>  
_AWSë¼ëŠ” ê²ƒì„ ì²˜ìŒ ì•Œê²Œë˜ì–´ ë³´ëŒì°¼ë‹¤.ğŸ‘_

ğŸª<b>ì˜¤ë¯¼ìˆ˜</b>  
_AWSì„ í†µí•´ ë°°í¬í•´ë³´ë‹ˆ ì¢‹ì€ ê²½í—˜ì´ì—ˆë‹¤.ğŸ‘_

